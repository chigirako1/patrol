<% provide(:title, %!画像一覧 - #{@twtid}!) %>

<h3 id="twt_pic_list">twt pic (<%= link_to "@#{@twtid}", get_twt_user_url(@twtid), target: :_blank, rel: "noopener noreferrer" %>)</h3>

<% twt_acnt = Twitter.find_by(twtid: @twtid) %>
<% if twt_acnt == nil %>
    <%= link_to "New Twt", new_twitter_path(twtid: @twtid) %>
    <br />
<% else %>
    twt:<%= twt_acnt.twt_screen_name %>[<%= link_to "show", twt_acnt, target: :_blank, rel: "noopener noreferrer" %>]
    (アクセス:<%= twt_acnt.last_access_datetime_disp %>)
    <%= twt_acnt.status %>,<%= twt_acnt.drawing_method %>
    <br />

    <% pxv_acnt = Artist.find_by(pxvid: twt_acnt.pxvid) %>
    <% if pxv_acnt != nil %>
        pxv:<%= pxv_acnt.pxvname %> [<%= link_to "show", pxv_acnt, target: :_blank, rel: "noopener noreferrer" %>]
        <br />
    <% end %>
<% end %>

<% pxv_artist = Artist.find_by(twtid: @twtid) %>
<% if pxv_artist != nil %>
    pxv:<%= pxv_artist.pxvname %> [<%= link_to "show", pxv_artist, target: :_blank, rel: "noopener noreferrer" %>]
        <%= pxv_artist.get_datetime_string(pxv_artist.last_ul_datetime) %>
        <%= pxv_artist.status %>
    <br />
<% end %>
<hr />


<% twt_pic_list = @twt_pic_path_list.map {|x| [Twt::twt_path_str(x), x]}.sort.reverse %>

更新頻度：<%= (Twt::calc_freq(@twt_pic_path_list)).to_f %>/100日
<br />

<% twt_pic_list.each do |elem| %>
    <% path = elem[1] %>
    <%= link_to image_tag(path, width: '10%', height: '10%', :alt => path), path, target: :_blank, rel: "noopener noreferrer" %>
<% end %>
<br />

<% twt_pic_list.each.with_index(1) do |elem, idx| %>
    <%= idx %>:<%= elem[0] %><br />
<% end %>
<br />

<hr />
<%= form_with url: artists_path, local: true, method: :get do |f| %>
    <%= f.label :file, style: "display: block" %>
    <%= f.select :file, 
      options_for_select(
        [
          ['検索'],
        ],
        selected: params[:file] 
      ) %>
    <br />

    検索：<%= f.text_field :search_word %>
    <%= f.select :match_method, options_for_select([["(自動判断)","auto"], ["を含む","partial_match"], ["完全一致","perfect_match"], ["から始まる","begin_match"],  ["で終わる","end_match"]]) %>
    <%= f.select :target_col, options_for_select([['(自動判断)'], ['pxvname'], ['pxvid']]) %>
    <br />
    <%= f.submit "検索", name: nil %>
<% end %>
