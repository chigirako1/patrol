<p style="color: green"><%= notice %></p>

<%= link_to "Return", root_path %>

<h1>Artists</h1>

<%= link_to "default", "../artists" %>
<%= link_to "twt", "../artists?twt=twt&display_number=50&group_by=last_ul_datetime&sort_by=access_date_X_last_ul_datetime" %>
<%= link_to "ai", "../artists?ai=ai&display_number=25&group_by=last_ul_datetime&sort_by=access_date_X_last_ul_datetime" %>
<%= link_to "2023", "../artists?year=2023&display_number=100" %>
<%= link_to "many", "../artists?amount=many&display_number=100&group_by=pxvname&sort_by=access_date_X_pxvname_X_recent_filenum" %>
<%= link_to "few", "../artists?amount=few&display_number=100&group_by=last_ul_datetime&sort_by=access_date_X_recent_filenum" %>

<% @artists_group.each do |key, artists| %>
<h2><%= key %>(<%= artists.size %>)</h2>
<table border="1" rules="all">
  <tr>
    <th>id</th>
    <th>pxvname</th>
    <th>pxvid</th>
    <th>show</th>
    <th>ファイル数</th>
    <th>最近のファイル数</th>
    <th>優先度</th>
    <th>twt</th>
    <th>最終DL日</th>
    <th>最新投稿日</th>
    <th>最新アクセス日</th>
    <th>状態</th>
    <th>コメント</th>
  </tr>
<% artists.first(@size_per_table).each do |artist| %>
  <tr>
    <td><%= artist["id"] %></td>
    <td><%= artist["pxvname"] %></td>
    <% url = %!https://www.pixiv.net/users/#{artist["pxvid"]}! %>
    <td><%= link_to artist["pxvid"], url, target: :_blank, rel: "noopener noreferrer" %></td>
    <td><%= link_to "■■■■", artist, target: :_blank, rel: "noopener noreferrer" %></td>
    <td><%= artist["filenum"] %></td>
    <td><%= artist["recent_filenum"] %></td>
    <td><%= artist["priority"] %></td>
    <% if artist["twtid"] == "" %>
      <td></td>
    <% else %>
      <% url = %!https://twitter.com/#{artist["twtid"]}! %>
      <td><%= link_to "@#{artist["twtid"]}", url, target: :_blank, rel: "noopener noreferrer" %></td>
    <% end %>
    <td><%= artist["last_dl_datetime"].in_time_zone('Tokyo').strftime("%Y-%m") %></td>
    <td><%= artist["last_ul_datetime"].in_time_zone('Tokyo').strftime("%Y-%m") %></td>
    <% if artist["last_access_datetime"] == nil %>
      <% last_access_datetime = "" %>
    <% else %>
      <% last_access_datetime = artist["last_access_datetime"].in_time_zone('Tokyo').strftime("%Y-%m-%d") %>
    <% end %>
    <td><%= last_access_datetime %></td>
    <td><%= artist["status"] %></td>
    <td><%= artist["comment"] %></td>
  </tr>
<% end %>
</table>
<% end %>
</table>

<hr />
<%= link_to "New artist", new_artist_path %>
